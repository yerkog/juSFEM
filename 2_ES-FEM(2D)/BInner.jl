include("Vector4.jl")
function BQ(x1,y1,x2,y2,x3,y3,x4,y4)
    xi1 = (x1+x2+x3)/3
    yi1 = (y1+y2+y3)/3
    xi2 = (x1+x3+x4)/3
    yi2 = (y1+y3+y4)/3
     lp = [sqrt((x1-xi1)^2+(y1-yi1)^2) sqrt((xi1-x3)^2+(yi1-y3)^2) sqrt((x3-xi2)^2+(y3-yi2)^2) sqrt((xi2-x1)^2+(yi2-y1)^2)]
      n = vector4(x1,y1,xi1,yi1,x3,y3,xi2,yi2)
    Gp1 = [4/6 1/6 1/6 4/6]
    b11 = n[1]*Gp1[1]*lp[1]
    b12 = n[3]*Gp1[2]*lp[2]
    b13 = n[5]*Gp1[3]*lp[3]
    b14 = n[7]*Gp1[4]*lp[4]
    bx1 = (3/0.0008)*(b11+b12+b13+b14)
    b15 = n[2]*Gp1[1]*lp[1]
    b16 = n[4]*Gp1[2]*lp[2]
    b17 = n[6]*Gp1[3]*lp[3]
    b18 = n[8]*Gp1[4]*lp[4]
    by1 = (3/0.0008)*(b15+b16+b17+b18)
     B1 = [bx1 0; 0 by1; by1 bx1]
    Gp2 = [1/6 1/6 0 0]
    b21 = n[1]*Gp2[1]*lp[1]
    b22 = n[3]*Gp2[2]*lp[2]
    b23 = n[5]*Gp2[3]*lp[3]
    b24 = n[7]*Gp2[4]*lp[4]
    bx2 = (3/0.0008)*(b21+b22+b23+b24)
    b25 = n[2]*Gp2[1]*lp[1]
    b26 = n[4]*Gp2[2]*lp[2]
    b27 = n[6]*Gp2[3]*lp[3]
    b28 = n[8]*Gp2[4]*lp[4]
    by2 = (3/0.0008)*(b25+b26+b27+b28)
     B2 = [bx2 0; 0 by2; by2 bx2]
    Gp3 = [1/6 4/6 4/6 1/6]
    b31 = n[1]*Gp3[1]*lp[1]
    b32 = n[3]*Gp3[2]*lp[2]
    b33 = n[5]*Gp3[3]*lp[3]
    b34 = n[7]*Gp3[4]*lp[4]
    bx3 = (3/0.0008)*(b31+b32+b33+b34)
    b35 = n[2]*Gp3[1]*lp[1]
    b36 = n[4]*Gp3[2]*lp[2]
    b37 = n[6]*Gp3[3]*lp[3]
    b38 = n[8]*Gp3[4]*lp[4]
    by3 = (3/0.0008)*(b35+b36+b37+b38)
     B3 = [bx3 0; 0 by3; by3 bx3]
    Gp4 = [0 0 1/6 1/6]
    b41 = n[1]*Gp4[1]*lp[1]
    b42 = n[3]*Gp4[2]*lp[2]
    b43 = n[5]*Gp4[3]*lp[3]
    b44 = n[7]*Gp4[4]*lp[4]
    bx4 = (3/0.0008)*(b41+b42+b43+b44)
    b45 = n[2]*Gp4[1]*lp[1]
    b46 = n[4]*Gp4[2]*lp[2]
    b47 = n[6]*Gp4[3]*lp[3]
    b48 = n[8]*Gp4[4]*lp[4]
    by4 = (3/0.0008)*(b45+b46+b47+b48)
     B4 = [bx4 0; 0 by4; by4 bx4]
      B = [B1 B2 B3 B4]
    return B
end 
